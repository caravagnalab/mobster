<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Assign new observations to the clusters inside a MOBSTER fit. — Clusters_denovo • mobster</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Assign new observations to the clusters inside a MOBSTER fit. — Clusters_denovo" />
<meta property="og:description" content="For a new set of observations in the MOBSTER input format,
the parameters and clusters of a MOBSTER fit are used to determine the
assignments of the new points. MOBSTER density function is used to determine
which cluster has the highest density for each observation, and the cluster
label is computed accordingly." />
<meta property="og:image" content="caravagn.github.io/mobster/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mobster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mobster.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/a1_introduction.html">1. Introduction</a>
    </li>
    <li>
      <a href="../articles/a2_plotting.html">2. Plotting fits</a>
    </li>
    <li>
      <a href="../articles/a3_bootstrap.html">3. Confidence estimation by the bootstrap</a>
    </li>
    <li>
      <a href="../articles/a4_popgen.html">4. Population Genetics statistics</a>
    </li>
    <li>
      <a href="../articles/a5_dnds.html">5. dN/dS statistics</a>
    </li>
    <li>
      <a href="../articles/a6_CloneTrees.html">6. Clone trees from clusters</a>
    </li>
    <li>
      <a href="../articles/a7_Example_tumour_simulation.html">7. Visualizing subclonal expansions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/caravagn/mobster/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Assign new observations to the clusters inside a MOBSTER fit.</h1>
    <small class="dont-index">Source: <a href='https://github.com/caravagn/mobsterR/Clusters_denovo.R'><code>R/Clusters_denovo.R</code></a></small>
    <div class="hidden name"><code>Clusters_denovo.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For a new set of observations in the MOBSTER input format,
the parameters and clusters of a MOBSTER fit are used to determine the
assignments of the new points. MOBSTER density function is used to determine
which cluster has the highest density for each observation, and the cluster
label is computed accordingly.</p>
    </div>

    <pre class="usage"><span class='fu'>Clusters_denovo</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A MOBSTER fit.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A MOBSTER input dataset, which has to have a VAF numeric column without NAs.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The data in <code>y</code> is augmented with a colum per mixture component reporting
the corresponding density value. A final colum `cluster` is also added reporting the
component name for the hard clustering assignment of the point.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Want to understand how all the pieces fit together? Read R for Data</span>
#&gt; <span class='message'>Science: https://r4ds.had.co.nz/</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>'fit_example'</span>, package <span class='op'>=</span> <span class='st'>'mobster'</span><span class='op'>)</span>

<span class='co'># Generate some randome numbers and assign them to the most likely mixture component</span>
<span class='va'>new_assignments</span> <span class='op'>=</span> <span class='fu'>Clusters_denovo</span><span class='op'>(</span><span class='va'>fit_example</span><span class='op'>$</span><span class='va'>best</span>, <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>VAF <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> 
</div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* . -&gt; ....1</span>
#&gt; <span class='message'>* . -&gt; ....2</span></div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* . -&gt; ....3</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>new_assignments</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 1,000 x 5</span><span>
#&gt;        VAF     Tail      C1       C2 cluster
#&gt;      </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>    </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>    </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>  
#&gt; </span><span style='color: #BCBCBC;'> 1</span><span> 0.080</span><span style='text-decoration: underline;'>8</span><span>     0.977 -</span><span style='color: #BB0000;'>155.</span><span>     -</span><span style='color: #BB0000;'>4.23</span><span>  Tail   
#&gt; </span><span style='color: #BCBCBC;'> 2</span><span> 0.834     -</span><span style='color: #BB0000;'>4.27</span><span>   -</span><span style='color: #BB0000;'>92.5</span><span>  -</span><span style='color: #BB0000;'>248.</span><span>    Tail   
#&gt; </span><span style='color: #BCBCBC;'> 3</span><span> 0.601     -</span><span style='color: #BB0000;'>3.54</span><span>    -</span><span style='color: #BB0000;'>6.70</span><span>  -</span><span style='color: #BB0000;'>95.6</span><span>   Tail   
#&gt; </span><span style='color: #BCBCBC;'> 4</span><span> 0.157     -</span><span style='color: #BB0000;'>0.521</span><span>  -</span><span style='color: #BB0000;'>77.9</span><span>     0.730 C2     
#&gt; </span><span style='color: #BCBCBC;'> 5</span><span> 0.007</span><span style='text-decoration: underline;'>40</span><span> -</span><span style='color: #BB0000;'>Inf</span><span>     -</span><span style='color: #BB0000;'>469.</span><span>    -</span><span style='color: #BB0000;'>65.6</span><span>   C2     
#&gt; </span><span style='color: #BCBCBC;'> 6</span><span> 0.466     -</span><span style='color: #BB0000;'>2.97</span><span>     1.92  -</span><span style='color: #BB0000;'>49.7</span><span>   C1     
#&gt; </span><span style='color: #BCBCBC;'> 7</span><span> 0.498     -</span><span style='color: #BB0000;'>3.11</span><span>     1.78  -</span><span style='color: #BB0000;'>58.9</span><span>   C1     
#&gt; </span><span style='color: #BCBCBC;'> 8</span><span> 0.290     -</span><span style='color: #BB0000;'>1.90</span><span>   -</span><span style='color: #BB0000;'>20.3</span><span>   -</span><span style='color: #BB0000;'>11.7</span><span>   Tail   
#&gt; </span><span style='color: #BCBCBC;'> 9</span><span> 0.733     -</span><span style='color: #BB0000;'>3.98</span><span>   -</span><span style='color: #BB0000;'>39.3</span><span>  -</span><span style='color: #BB0000;'>164.</span><span>    Tail   
#&gt; </span><span style='color: #BCBCBC;'>10</span><span> 0.773     -</span><span style='color: #BB0000;'>4.10</span><span>   -</span><span style='color: #BB0000;'>55.9</span><span>  -</span><span style='color: #BB0000;'>192.</span><span>    Tail   
#&gt; </span><span style='color: #949494;'># … with 990 more rows</span><span></div><div class='input'>
<span class='co'># Plot a histogram coloured according to the clusters</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>new_assignments</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>VAF</span>, fill <span class='op'>=</span> <span class='va'>cluster</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>binwidth <span class='op'>=</span> <span class='fl'>0.01</span><span class='op'>)</span>
</div><div class='img'><img src='Clusters_denovo-1.png' alt='' width='700' height='433' /></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://sites.google.com/site/giuliocaravagna/'>Giulio Caravagna</a>, Luca De Sano.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


