<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3. Bootstrap confidence estimation • mobster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3. Bootstrap confidence estimation">
<meta property="og:description" content="">
<meta property="og:image" content="caravagn.github.io/mobster/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mobster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mobster.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CloneTrees.html">6. Clone trees</a>
    </li>
    <li>
      <a href="../articles/Example_tumour_simulation.html">Visualizing subclonal expansions</a>
    </li>
    <li>
      <a href="../articles/bootstrap.html">3. Bootstrap confidence estimation</a>
    </li>
    <li>
      <a href="../articles/dnds.html">5. dN/dS statisticss</a>
    </li>
    <li>
      <a href="../articles/introduction.html">1. Introduction</a>
    </li>
    <li>
      <a href="../articles/plotting.html">2. Plotting fits</a>
    </li>
    <li>
      <a href="../articles/popgen.html">4. Population Genetics statistics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>3. Bootstrap confidence estimation</h1>
                        <h4 class="author">Giulio Caravagna</h4>
            
            <h4 class="date">January 2020</h4>
      
      
      <div class="hidden name"><code>bootstrap.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mobster)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a></code></pre></div>
<p>This vignette describes how to compute the <em>bootstrap</em> confidence of a MOBSTER model.</p>
<div id="bootstrapping-a-model" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrapping-a-model" class="anchor"></a>Bootstrapping a model</h2>
<p>Both <em>parametric</em> and <em>nonparametric</em> bootstrap options are available: the former samples data from the model, the latter re-samples the data (with repetitions). Statistics are bootstrap estimates (averages) of the bootstrap fits. In both cases a model bootstrap probability can be computed, as well as the probability of clustering together any two mutations.</p>
<p>We show this with a small synthetic dataset .to speed up the computation.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Data generation</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">dataset =<span class="st"> </span><span class="kw"><a href="../reference/random_dataset.html">random_dataset</a></span>(</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">N =</span> <span class="dv">400</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">seed =</span> <span class="dv">123</span>, </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="dt">Beta_variance_scaling =</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># Fit model -- FAST option to speed up the vignette</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">fit =<span class="st"> </span><span class="kw"><a href="../reference/mobster_fit.html">mobster_fit</a></span>(dataset<span class="op">$</span>data, <span class="dt">auto_setup =</span> <span class="st">'FAST'</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  [ MOBSTER fit ]</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># Composition with cowplot</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">cowplot<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  dataset<span class="op">$</span>plot, </a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  <span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(fit<span class="op">$</span>best), </a>
<a class="sourceLine" id="cb2-16" data-line-number="16">  <span class="dt">ncol =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb2-17" data-line-number="17">  <span class="dt">align =</span> <span class="st">'h'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="st">  </span>print</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>Now we can compute <code>n.resamples</code> nonparametric bootstraps using function <code>mobster_bootstrap</code>, passing parameters to the calls of <code>mobster_fit</code>. This function by defaults runs the fits in parallel (using a default percentage of the available cores); parallel computing capabilities are achieved using package <a href="https://github.com/caravagn/easypar">easypar</a>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># The returned object contains also the list of bootstrap resamples, and the fits.</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">bootstrap_results =<span class="st"> </span><span class="kw"><a href="../reference/mobster_bootstrap.html">mobster_bootstrap</a></span>(</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  fit<span class="op">$</span>best,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">bootstrap =</span> <span class="st">'nonparametric'</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">n.resamples =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">auto_setup =</span> <span class="st">'FAST'</span> <span class="co"># forwarded to mobster_fit</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;  [ MOBSTER bootstrap ~ 25 resamples from nonparametric bootstrap ]</span></a></code></pre></div>
<p>The output object includes the bootstrap resamples, the fits and possible error returned by the runs.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Resamples are available for inspection as list of lists, </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># with a mapping to record the mutation id of the resample data.</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># Ids are row numbers.</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_results<span class="op">$</span>resamples[[<span class="dv">1</span>]][[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>())</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; # A tibble: 400 x 3</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;       id    VAF original.id</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;    &lt;int&gt;  &lt;dbl&gt;       &lt;int&gt;</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  1     1 0.877           10</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  2     2 0.965           58</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  3     3 0.791           77</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  4     4 0.715           98</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  5     5 0.270          338</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  6     6 0.405          174</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  7     7 0.482          129</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;  8     8 0.0691         361</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;  9     9 0.270          338</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; 10    10 0.829           93</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; # … with 390 more rows</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co"># Fits are available inside the $fits list</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_results<span class="op">$</span>fits[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; ── [ MOBSTER ] My MOBSTER model n = 400 with k = 2 Beta(s) and a tail ────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; ● Clusters: π = 46% [C2], 32% [C1] and 22% [Tail], with π &gt; 0.</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; ● Tail [n = 77, 22%] with alpha = 1.1.</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; ● Beta C1 [n = 129, 32%] with mean = 0.79.</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; ● Beta C2 [n = 194, 46%] with mean = 0.44.</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; ℹ Score(s): NLL = -76.38; ICL = -28.36 (-77.8), H = 70.48 (21.03). Fit converged by MM in 92 steps.</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(bootstrap_results<span class="op">$</span>fits[[<span class="dv">1</span>]])</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Errors of each run are available, if any.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_results<span class="op">$</span>errors)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; NULL</span></a></code></pre></div>
</div>
<div id="bootstrap-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrap-statistics" class="anchor"></a>Bootstrap statistics</h2>
<p>Bootstrap statistics can be computed with <code>bootstrapped_statistics</code>.</p>
<p>With nonparametric bootstrap the data co-clustering probability is also computed (the probability of any pair of mutations in the data to be clustered together). Note that this probability depends on the joint resample probability of each pair of mutations (each bootstrapped with probability <span class="math inline">\(1/n\)</span>, for <span class="math inline">\(n\)</span> mutations).</p>
<p><code>bootstrap_statistics</code> shows to screen several statistics.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">bootstrap_statistics =<span class="st"> </span><span class="kw"><a href="../reference/bootstrapped_statistics.html">bootstrapped_statistics</a></span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="dt">bootstrap_results =</span> bootstrap_results</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  )</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; ℹ Computing model frequency</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;   Model           Frequency fit.model</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;   &lt;fct&gt;               &lt;dbl&gt; &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; 1 K = 2 with tail       0.6 TRUE     </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; 2 K = 1 with tail       0.4 FALSE</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">                           </a>
<a class="sourceLine" id="cb6-13" data-line-number="13">✓ Computing model frequency ... done</a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">ℹ Confidence <span class="kw">Intervals</span> (CI) <span class="cf">for</span> empirical quantiles</a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; Mixing proportions </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt;  # A tibble: 3 x 8</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt;   cluster statistics   min lower_quantile higher_quantile   max fit.value</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; 1 C1      Mixing pr… 0.256          0.258           0.866 0.873     0.292</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; 2 C2      Mixing pr… 0.440          0.441           0.526 0.527     0.463</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; 3 Tail    Mixing pr… 0.127          0.134           0.263 0.273     0.245</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; Tail shape/ scale </span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt;  # A tibble: 2 x 8</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt;   cluster statistics    min lower_quantile higher_quantile    max fit.value</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; 1 Tail    Scale      0.0500         0.0500          0.0518 0.0526    0.0500</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; 2 Tail    Shape      1.08           1.14            2.53   2.62      1.25  </span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt; Beta peaks </span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt;  # A tibble: 4 x 8</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt;   cluster statistics     min lower_quantile higher_quantile    max fit.value</span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; 1 C1      Mean       0.526          0.532            0.818  0.824    0.798  </span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; 2 C1      Variance   0.00356        0.00416          0.0514 0.0517   0.00664</span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt; 3 C2      Mean       0.431          0.432            0.464  0.467    0.446  </span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"><span class="co">#&gt; 4 C2      Variance   0.00540        0.00556          0.0104 0.0109   0.00731</span></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45">                                                   </a>
<a class="sourceLine" id="cb6-46" data-line-number="46">✓ Confidence <span class="kw">Intervals</span> (CI) <span class="cf">for</span> empirical quantiles ... done</a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"></a>
<a class="sourceLine" id="cb6-49" data-line-number="49">ℹ Co<span class="op">-</span>clustering probability from nonparametric bootstrap</a>
<a class="sourceLine" id="cb6-50" data-line-number="50">                                                        </a>
<a class="sourceLine" id="cb6-51" data-line-number="51">✓ Co<span class="op">-</span>clustering probability from nonparametric bootstrap ... done</a></code></pre></div>
</div>
<div id="visualising-bootstrap-results" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-bootstrap-results" class="anchor"></a>Visualising bootstrap results</h2>
<p>Object <code>bootstrap_statistics</code> contains tibbles that can be plot with specific <code>mobster</code> functions.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># All bootstrapped values</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_values)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; # A tibble: 325 x 5</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    cluster statistics fit.value init.value resample</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  1 Tail    Shape        1.08       1.14           1</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  2 Tail    Scale        0.0508     0.0508         1</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  3 Tail    Mean         0.670      0.414          1</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  4 Tail    Variance   Inf        Inf              1</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  5 C2      a           14.0       20.4            1</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  6 C2      b           17.6       20.4            1</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;  7 C2      Mean         0.443      0.645          1</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;  8 C2      Variance     0.00757    0.00702        1</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;  9 C1      a           18.6       16.5            1</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; 10 C1      b            4.84      16.5            1</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; # … with 315 more rows</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co"># The model probability</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_model)</a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;   Model           Frequency fit.model</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt;   &lt;fct&gt;               &lt;dbl&gt; &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; 1 K = 2 with tail       0.6 TRUE     </span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; 2 K = 1 with tail       0.4 FALSE</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co"># The parameter stastics</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_statistics)</a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; # A tibble: 15 x 8</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt;    cluster statistics     min lower_quantile higher_quantile      max fit.value</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt;  1 C1      a          2.08e+0        2.11            29.4     35.4     18.6    </span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt;  2 C1      b          1.69e+0        1.70             6.89     9.04     4.69   </span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt;  3 C1      Mean       5.26e-1        0.532            0.818    0.824    0.798  </span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt;  4 C1      Mixing pr… 2.56e-1        0.258            0.866    0.873    0.292  </span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt;  5 C1      Variance   3.56e-3        0.00416          0.0514   0.0517   0.00664</span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt;  6 C2      a          9.32e+0       10.2             19.2     19.8     14.6    </span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt;  7 C2      b          1.23e+1       12.7             24.2     24.9     18.2    </span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt;  8 C2      Mean       4.31e-1        0.432            0.464    0.467    0.446  </span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt;  9 C2      Mixing pr… 4.40e-1        0.441            0.526    0.527    0.463  </span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"><span class="co">#&gt; 10 C2      Variance   5.40e-3        0.00556          0.0104   0.0109   0.00731</span></a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co">#&gt; 11 Tail    Mean       8.09e-2        0.0829           0.477    0.670    0.247  </span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42"><span class="co">#&gt; 12 Tail    Mixing pr… 1.27e-1        0.134            0.263    0.273    0.245  </span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43"><span class="co">#&gt; 13 Tail    Scale      5.00e-2        0.0500           0.0518   0.0526   0.0500 </span></a>
<a class="sourceLine" id="cb7-44" data-line-number="44"><span class="co">#&gt; 14 Tail    Shape      1.08e+0        1.14             2.53     2.62     1.25   </span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="co">#&gt; 15 Tail    Variance   4.04e-3        0.00533        Inf      Inf      Inf      </span></a>
<a class="sourceLine" id="cb7-46" data-line-number="46"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a></code></pre></div>
<p>Bootstrapping, one can plot the model frequency across re-samples. A model is identified by its mixture components (e.g., 2 Betas plus one tail).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/plot_bootstrap_model_frequency.html">plot_bootstrap_model_frequency</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  bootstrap_results, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  bootstrap_statistics</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  )</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-9-1.png" width="240"></p>
<p>The bootstrap estimates of the parameters can be visualised.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Plot the mixing proportions</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">mplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_mixing_proportions.html">plot_bootstrap_mixing_proportions</a></span>(</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co"># Plot the tail parameters</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">tplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_tail.html">plot_bootstrap_tail</a></span>(</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-11" data-line-number="11">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-12" data-line-number="12">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">  )</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co"># Plot the Beta parameters</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16">bplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_Beta.html">plot_bootstrap_Beta</a></span>(</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-18" data-line-number="18">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-19" data-line-number="19">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">  )</a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; Warning: Removed 4 rows containing missing values (geom_bar).</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; Warning: Removed 4 rows containing missing values (geom_bar).</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co"># Figure</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26">figure =<span class="st"> </span>ggpubr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(</a>
<a class="sourceLine" id="cb9-27" data-line-number="27">  mplot,</a>
<a class="sourceLine" id="cb9-28" data-line-number="28">  tplot,</a>
<a class="sourceLine" id="cb9-29" data-line-number="29">  bplot,</a>
<a class="sourceLine" id="cb9-30" data-line-number="30">  <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-31" data-line-number="31">  <span class="dt">widths =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-32" data-line-number="32">)</a>
<a class="sourceLine" id="cb9-33" data-line-number="33"></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(figure)</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-10-1.png" width="1152"></p>
<p>For a nonparametric bootstrap we can plot also the co-clustering probability of the data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="../reference/plot_bootstrap_coclustering.html">plot_bootstrap_coclustering</a></span>(</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  )</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-11-1.png" width="537.6"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#bootstrapping-a-model">Bootstrapping a model</a></li>
      <li><a href="#bootstrap-statistics">Bootstrap statistics</a></li>
      <li><a href="#visualising-bootstrap-results">Visualising bootstrap results</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://sites.google.com/site/giuliocaravagna/">Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
